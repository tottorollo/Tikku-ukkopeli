<!DOCTYPE html>
<html lang="fi">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tikku-ukko Taistelu</title>
<style>
body {
  margin: 0;
  background: #222;
  touch-action: none;
}
canvas {
  display: block;
}
.button {
  position: absolute;
  bottom: 20px;
  width: 60px;
  height: 60px;
  background: rgba(255,255,255,0.2);
  border-radius: 50%;
  text-align: center;
  line-height: 60px;
  font-size: 24px;
  color: white;
  user-select: none;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<!-- Player 1 -->
<div class="button" style="left:20px" id="p1left">â¬…ï¸</div>
<div class="button" style="left:90px" id="p1right">â¡ï¸</div>
<div class="button" style="left:160px" id="p1jump">â¬†ï¸</div>
<div class="button" style="left:230px" id="p1hit">ğŸ¤œ</div>

<!-- Player 2 -->
<div class="button" style="right:230px" id="p2hit">ğŸ¤œ</div>
<div class="button" style="right:160px" id="p2jump">â¬†ï¸</div>
<div class="button" style="right:90px" id="p2left">â¬…ï¸</div>
<div class="button" style="right:20px" id="p2right">â¡ï¸</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const gravity = 0.6;
const ground = canvas.height - 80;

function player(x, color) {
  return {
    x, y: ground, vx: 0, vy: 0,
    hit: false,
    hp: 100,
    color
  };
}

const p1 = player(150, "cyan");
const p2 = player(canvas.width - 150, "orange");

function drawPlayer(p) {
  ctx.strokeStyle = p.color;
  ctx.lineWidth = 4;

  // head
  ctx.beginPath();
  ctx.arc(p.x, p.y - 50, 10, 0, Math.PI * 2);
  ctx.stroke();

  // body
  ctx.beginPath();
  ctx.moveTo(p.x, p.y - 40);
  ctx.lineTo(p.x, p.y);
  ctx.stroke();

  // arms
  ctx.beginPath();
  ctx.moveTo(p.x - 15, p.y - 30);
  ctx.lineTo(p.x + 15, p.y - 30);
  ctx.stroke();

  // legs
  ctx.beginPath();
  ctx.moveTo(p.x, p.y);
  ctx.lineTo(p.x - 10, p.y + 20);
  ctx.moveTo(p.x, p.y);
  ctx.lineTo(p.x + 10, p.y + 20);
  ctx.stroke();
}

function update(p) {
  p.vy += gravity;
  p.x += p.vx;
  p.y += p.vy;

  if (p.y > ground) {
    p.y = ground;
    p.vy = 0;
  }

  p.vx *= 0.8;
}

function hit(attacker, defender) {
  if (attacker.hit && Math.abs(attacker.x - defender.x) < 40) {
    defender.hp -= 1;
  }
}

function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  update(p1);
  update(p2);

  hit(p1, p2);
  hit(p2, p1);

  drawPlayer(p1);
  drawPlayer(p2);

  // HP bars
  ctx.fillStyle = "cyan";
  ctx.fillRect(20,20,p1.hp*2,10);
  ctx.fillStyle = "orange";
  ctx.fillRect(canvas.width-220,20,p2.hp*2,10);

  requestAnimationFrame(loop);
}
loop();

// Touch controls
function bind(id, fnDown, fnUp=()=>{}) {
  const el = document.getElementById(id);
  el.addEventListener("touchstart", e => {e.preventDefault(); fnDown();});
  el.addEventListener("touchend", e => {e.preventDefault(); fnUp();});
}

// Player 1
bind("p1left", ()=>p1.vx=-5);
bind("p1right", ()=>p1.vx=5);
bind("p1jump", ()=>{ if(p1.y>=ground) p1.vy=-12; });
bind("p1hit", ()=>{ p1.hit=true; setTimeout(()=>p1.hit=false,200); });

// Player 2
bind("p2left", ()=>p2.vx=-5);
bind("p2right", ()=>p2.vx=5);
bind("p2jump", ()=>{ if(p2.y>=ground) p2.vy=-12; });
bind("p2hit", ()=>{ p2.hit=true; setTimeout(()=>p2.hit=false,200); });
</script>
</body>
</html>
